\section{MIP on arbitrary polygonal cells} \label{sec_mip}
\subsection{Solution Principle}
In this Section, we recall the MIP technique and extend it to arbitrary
polygonal/polyhedral cells. As noted earlier, in thick diffusive
configuration, standard iterative technique can be slowly converging. DSA
can be employed to accelerate the convergence.
The idea behind synthetic acceleration is that the error between the (yet
unknown) transport solution and the latest iterate can be estimated from a
computationally less expensive process, yielding a correction term to be added
to the latest iterate in order to improve the next iterate. In DSA, the
corrective scalar flux contribution is sought through the following
diffusion solve, where the source term is due to the difference between
successive iterates:
\begin{equation}
  \bs{A}\ \delta \Phi = \bs{\Sigma}\(\Phi^{(\ell+1/2)} - \Phi^{(\ell)}\).
\end{equation}
Then, the next iterate is obtained as follows:
\begin{equation}
  \Phi^{(\ell+1)} = \Phi^{(\ell+1/2)}+\delta \Phi.
\end{equation}
Similarly, DSA can be obtained to precondition GMRes transport solves. The
final form of that system is:
\begin{equation}
  \(\bs{I} +\bs{A}^{-1} \bs{\Sigma}\)\(\bs{I}-\bs{DL}^{-1}\bs{M\Sigma}\) \Psi
  = \(\bs{I}+\bs{A}^{-1}\bs{\Sigma}\) \bs{DL}^{-1} S.
\end{equation}
Both approaches, SI+DSA or DSA-preconditioned GMRES, require a linear system
solve involving the diffusion matrix $\bs{A}$. Ideally, such a matrix should
be SPD (such that efficient techniques can be employed in its linear solve)
and easy to form (even on arbitrary grids).
\subsection{Modified Interior Penalty DSA}
Now that the PWLD finite elements have been introduced and the SI+DSA method is
known, we can define the Modified Interior Penalty DSA \cite{mip}. This DSA 
scheme uses discontinuous Galerkin finite elements for the spatial discretization 
and has been shown to be always stable for isotropic scattering on triangular
cells. It is based on the Interior Penalty scheme (IP). This method applies
directly the IP technique to the following diffusion update equation:
\begin{align}
  -\bn \mathrm{D} \bn \phi + \Sigma_a \phi &= Q_0 &\textrm{ for }\br \in
  \mc{D}\\
  \frac{1}{4}\phi - \frac{1}{2} \mathrm{D} \partial_n \phi & = 0 &\textrm{ for }
  \br \in \partial \mc{D}^d\\
  -\mathrm{D} \partial_n \phi &= J^{inc} & \textrm{ for } \br \in \partial
  \mc{D}^r,
\end{align}
where $\mathrm{D}$ is the diffusion coefficient, $\partial \mc{D}^d$ is the
boundary of the domain with Dirichlet condition, $\partial \mc{D}^r$ is the
boundary of the domain with reflective condition, $Q_0=\Sigma_s \delta
\Phi^{(\ell)}$, $J^{inc} = \sum_{\bo_m\cdot\bs{n}_b >0} w_m |\bo_m \cdot
\bs{n}_b| \delta \psi_m$, and $\partial_n = \bs{n}_e\cdot \bn$ where
$\bs{n}_e$ is the normal unit vector associated with a given edge $e$ (on the
boundary $\bs{n}_e = \bs{n}_b$). The only difference between IP and MIP is the
penalty factor $\kappa_e^{IP}$ used for IP is replaced by a new penalty factor
$\kappa_E^{MIP}$. Therefore, the weak form of MIP is given by:
\begin{equation}
b(\phi,\phi^*) = l(\phi^*)
\label{mip}
\end{equation}
with:
\begin{equation}
\begin{split}
b(\phi,\phi^*) =& \(\Sigma_a \phi,\phi^*\)_{\mc{D}}+
  (\mathrm{D}\bn\phi,\bn\phi^*)_{\mc{D}} + \(\kappa_e^{MIP} \llb\phi\rrb,
\llb\phi^*\rrb\)_{E_h^i} + \(\llb\phi\rrb,\ldb\mathrm{D}\partial_n
\phi^*\rdb\)_{E_h^i} +\\
& \(\ldb\mathrm{D}\partial_n \phi\rdb,\llb\phi^*\rrb\)_{E_h^i} +
\(\kappa_e^{MIP}
\phi,\phi^*\)_{\partial \mc{D}^d} -\frac{1}{2} \(\phi,\mathrm{D} \partial_n
\phi^*\)_{\partial \mc{D}^d} - \frac{1}{2}\(\mathrm{D}\partial_n
\phi,\phi^*\)_{\partial \mc{D}^d}
\label{mip_b}
\end{split}
\end{equation}
\begin{equation}
l(\phi^*) = (Q_0,\phi^*)_{\mc{D}}+ (J^{inc},\phi^*)_{\partial \mc{D}^r}
\label{mip_l}
\end{equation}
where $(f,g)_{\mc{D}} = \sum_{K\in \mathbb{T}_h} \(f,g\)_K$, 
$(f,g)_K = \int_K fg\ d\br$, $(f,g)_{E_h^i}=\sum_{e\in E_h^i}(f,g)_e$, 
$(f,g)_e = \int_e fg\ ds$,
 $\mathbb{T}_h$ is the mesh used to discretize the domain
$\mc{D}$ into nonoverlapping elements $K$, $E_h^i$ is the set of interior
edges, $\Sigma_a$ is the absorption cross section,
$\llb\phi\rrb = \phi^+ - \phi^-$ is the jump of $\phi$ at the interface between 
two elements, $\ldb\phi\rdb = \frac{\phi^+ + \phi^-}{2}$ is the mean of $\phi$ 
at the interface between two elements, 
$\phi^{\pm}=\lim_{s\rightarrow 0^{\pm}}\phi(\bs{r}+s\bs{n}_e)$, and
$\kappa_e^{MIP} = \max\(\kappa_e^{IP},\frac{1}{4}\)$
with:
\begin{equation}
\kappa_e^{IP} = \left\{
\begin{aligned}
&\frac{c(p^+)}{2} \frac{\mathrm{D^+}}{h_{\bot}^+} + \frac{c(p^-)}{2}
\frac{\mathrm{D}^-}{h_{\bot}^-} & \textrm{on interior edges, i.e., }
e\in E_h^i\\
&c(p) \frac{\mathrm{D}}{h_{\bot}} & \textrm{on boundary edges, i.e., } e
\in\partial \mc{D}^d 
\end{aligned}
\right. 
\end{equation}
where $c(p)$ is given by $c(p) = 2p (p+1)$, $p$ is the polynomial order ($p=1$
in this paper) and $h_{\bot}$ is the length of the cell in the direction
orthogonal to the edge $e$. MIP yields only a correction for the scalar flux
but by assuming that the angular dependence satisfies a diffusion expansion.

If PWLD finite elements are used instead of LD finite elements, the weak form 
of MIP is not modified. For general polygons, there is no 
simple way to compute $h_{\bot}$. To simplify this, we 
assume that the polygonal cells are not too far from being regular polygonal 
cells. In such cases, if the cell has an even number of edges, the orthogonal 
length equals two times the apothem, i.e. two times the segment between the 
midpoint of a side of the polygon and the center of this polygon 
$\(\textrm{apothem}=2\times \frac{\textrm{area}}{\textrm{perimeter}}\)$. If 
the cell has an odd number of edges, the orthogonal length is given by the 
apothem plus the circumradius, i.e. the radius of the circle circumscribed to 
the polygon $\(\textrm{circumradius}=\sqrt{\frac{2\times \textrm{area}}{V
\sin\(\frac{2\pi}{V}\)}}\)$. Therefore, $h_{\bot}$ is given in
\Cref{table_h_bot}:
\begin{table}[H]
  \begin{center}
    \caption{Orthogonal length of the cell for different cells.}
    \begin{tabular}{|c|c|c|c|c|}
      \hline
      Number of edges & 3 & 4 & $> 4$ and even & $> 4$ and odd \\
      \hline
      $h_{\bot}$ & $2 \times \frac{\textrm{area}}{L_e}$ &
$\frac{\textrm{area}}{L_e}$ & $4\times
\frac{\textrm{area}}{\textrm{perimeter}}$ & $2 \times
      \frac{\textrm{area}}{\textrm{perimeter}}+\sqrt{\frac{2\times
      \textrm{area}}{V\sin\(\frac{2\pi}{V}\)}}$\\
      \hline
    \end{tabular}
    \label{table_h_bot}
  \end{center}
\end{table}
