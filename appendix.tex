\appendix
\section{Building the mass matrix}
Let us define the mass matrix $M_{PWLD}$ and the mass matrix on a
``side'' sub-cell $M$. We assume that the third basis function is associated
to the middle point of the cell. The first (respectively second) basis function
on the cell correspond to the first (respectively second) basis function of
the ``side'' sub-cell.

{\allowdisplaybreaks
\begin{align}
& M_{PWLD}(0,0) = M_{PWLD}(0,0) + M(0,0) + \alpha M(0,2) + \alpha M(2,0) + 
\alpha^2M(2,2)\\
& M_{PWLD}(0,1) = M_{PWLD}(0,1) + M(0,1) + \alpha M(0,2) + \alpha M(2,1) + 
\alpha^2M(2,2)\\
& M_{PWLD}(0,2) = M_{PWLD}(0,2) + \alpha M(0,2) + \alpha^2 M(2,2)\\
& M_{PWLD}(0,3) = M_{PWLD}(0,3) + \alpha M(0,2) + \alpha^2M(2,2)\\
& M_{PWLD}(1,0) = M_{PWLD}(1,0) + M(1,0) + \alpha M(1,2) + \alpha M(2,0) + 
\alpha^2M(2,2)\\
& M_{PWLD}(1,1) = M_{PWLD}(1,1) + M(1,1) + \alpha M(1,2) + \alpha M(2,1) + 
\alpha^2M(2,2)\\
& M_{PWLD}(1,2) = M_{PWLD}(1,2) + \alpha M(1,2) + \alpha^2M(2,2)\\
& M_{PWLD}(1,3) = M_{PWLD}(1,3) + \alpha M(1,2) + \alpha^2M(2,2)\\
& M_{PWLD}(2,0) = M_{PWLD}(2,0) + \alpha M(2,0) + \alpha^2M(2,2)\\
& M_{PWLD}(2,1) = M_{PWLD}(2,1) + \alpha M(2,1) + \alpha^2M(2,2)\\
& M_{PWLD}(2,2) = M_{PWLD}(2,2) + \alpha^2M(2,2)\\
& M_{PWLD}(2,3) = M_{PWLD}(2,3) + \alpha^2M(2,2)\\
& M_{PWLD}(3,0) = M_{PWLD}(3,0) + \alpha M(2,0) + \alpha^2M(2,2)\\
& M_{PWLD}(3,1) = M_{PWLD}(3,1) + \alpha M(2,1) + \alpha^2M(2,2)\\
& M_{PWLD}(3,2) = M_{PWLD}(3,2) + \alpha^2M(2,2)\\
& M_{PWLD}(3,3) = M_{PWLD}(3,3) + \alpha^2M(2,2)
\end{align}}    
The mass matrix $M$ is given by:
\begin{equation}
M = \frac{A}{12}
\begin{pmatrix}
2 & 1 & 1\\
1 & 2 & 1\\
1 & 1 & 2
\end{pmatrix}
\end{equation}
where $A$ is the area of the ``side'' sub-cell.
